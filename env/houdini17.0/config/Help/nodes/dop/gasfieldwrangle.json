{"body": [{"indent": 0, "text": ["Gas Field Wrangle"], "type": "title", "extent": [85, 107], "level": 0}, {"indent": 0, "type": "summary", "extent": [107, 145], "text": ["Runs CVEX on a set of fields."]}, {"indent": 0, "type": "para", "extent": [145, 261], "text": ["This is a very powerful, low-level node that lets experts who are\nfamiliar with VEX tweak voxel values using code."]}, {"indent": 0, "type": "para", "extent": [261, 390], "text": ["This node corresponds to the ", {"text": ["Gas Field VOP DOP"], "fullpath": "/nodes/dop/gasfieldvop", "scheme": "Node", "type": "link", "value": "/nodes/dop/gasfieldvop"}, ",\nbut uses a textual VEX snippet instead of a VOP network."]}, {"body": [{"body": [{"indent": 4, "type": "para", "extent": [399, 530], "text": ["This node requires that you understand the ", {"text": ["vex language"], "fullpath": "/vex/index", "scheme": null, "type": "link", "value": "/vex/"}, ".\n    It is very easy to write incorrect code using this node."]}], "indent": 0, "role": "item", "type": "warning", "extent": [390, 399]}], "container": true, "role": "item_group", "type": "warning_group"}, {"indent": 0, "type": "para", "extent": [530, 745], "text": ["This node runs the snippet ", {"text": ["on every voxel in the input volume(s)"], "type": "em"}, ".\nThe snippet can edit the input geometry by changing attributes.\nIt can access information from other geometry using attributes and VEX functions."]}, {"body": [{"indent": 0, "blevel": 2, "type": "bullet", "extent": [745, 816], "text": ["Press ", {"keys": ["MMB"], "text": null, "type": "keys"}, " on the node to see any error output from the snippet."]}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [816, 1029], "text": ["You can use the VEX function ", {"text": ["ch"], "type": "code"}, " to evaluate parameters.\n  The path is relative to this node (", {"text": ["ch(\"parm\")"], "type": "code"}, " will evaluate the parameter ", {"text": ["parm"], "type": "code"}, " on this node).\n  This evaluation will be done at the current time."]}], "container": true, "type": "bullet_group"}, {"body": [{"type": "para", "indent": 0, "extent": [29, 294], "text": ["The ", {"text": ["VEX snippet"], "type": "ui"}, " parameter lets you enter a snippet of ", {"text": ["VEX code"], "fullpath": "/vex/index", "scheme": null, "type": "link", "value": "/vex/"}, " to run on the input geometry.\nSee ", {"text": ["VEX snippets"], "fullpath": "/vex/snippets", "scheme": null, "type": "link", "value": "/vex/snippets"}, " for information on special syntax in the snippet parameter.\nSee ", {"text": ["the VEX chapter"], "fullpath": "/vex/index", "scheme": null, "type": "link", "value": "/vex/"}, " for information on the VEX language."]}], "container": true, "level": 2, "text": ["Syntax"], "extent": [16, 29], "indent": 0, "type": "h", "id": null}, {"body": [{"indent": 0, "type": "para", "extent": [1119, 1362], "text": ["The current voxel value in a volume is available as ", {"text": ["@", {"text": ["volume_name"], "type": "var"}], "type": "code"}, ".\nYou can read this variable to get the current value, and assign it to change the value.\nFor example, to add ", {"text": ["0.1"], "type": "code"}, " to the value of every voxel in the float volume ", {"text": ["foo"], "type": "code"}, ":"]}, {"lang": "vex", "indent": 0, "type": "pre", "extent": [1362, 1388], "text": ["\n@foo += 0.1\n"]}, {"indent": 0, "type": "para", "extent": [1388, 1470], "text": ["If a volume does not have a name, it will automatically be bound to ", {"text": ["@density"], "type": "code"}, "."]}, {"indent": 0, "type": "para", "extent": [1470, 1619], "text": ["If you have multiple named volumes in the input, you can write a single snippet\nthat modifies the different volumes in different ways, for example:"]}, {"lang": "vex", "indent": 0, "type": "pre", "extent": [1619, 1669], "text": ["\n@foo += 0.1\n@bar += 0.2\n@baz += 0.3\n"]}], "indent": 0, "level": 2, "text": ["Reading and modifying the voxel value"], "extent": [1066, 1119], "container": true, "type": "h", "id": "values"}, {"body": [{"indent": 0, "type": "para", "extent": [1690, 1799], "text": ["You can create temporary variables.\nFor example, the following code reads an offset location from a point."]}, {"lang": "vex", "indent": 0, "type": "pre", "extent": [1799, 1901], "text": ["\nvector temp = @P;\ntemp += {0.1, 0.2, 0.3};\n@density = volumesample(@OpInput1, 0, temp);\n"]}], "indent": 0, "level": 2, "text": ["VEX variables"], "extent": [1669, 1690], "container": true, "type": "h", "id": null}, {"body": [{"indent": 0, "type": "para", "extent": [1924, 2028], "text": ["A number of variables are bound in the Volume VOP context. \nUse the ", {"text": ["@"], "type": "code"}, " prefix syntax to access them."]}, {"body": [{"body": [{"indent": 8, "type": "para", "extent": [2046, 2136], "text": ["The integer index of the current voxel.  With VDBs, this can be\n        negative."]}], "indent": 0, "type": "dt", "extent": [2028, 2046], "text": [{"text": ["ix"], "type": "code"}, ", ", {"text": ["iy"], "type": "code"}, ", ", {"text": ["iz"], "type": "code"}]}, {"body": [{"indent": 8, "type": "para", "extent": [2160, 2279], "text": ["The resolution of the current volume primitive.  For VDBs this\n        is the size of the active voxel region."]}], "indent": 0, "type": "dt", "extent": [2136, 2160], "text": [{"text": ["resx"], "type": "code"}, ", ", {"text": ["resy"], "type": "code"}, ", ", {"text": ["resz"], "type": "code"}]}, {"body": [{"indent": 8, "type": "para", "extent": [2303, 2404], "text": ["Vectors giving the length and orientation of the x, y, and z edges of\n        the 0th voxel."]}], "indent": 0, "type": "dt", "extent": [2279, 2303], "text": [{"text": ["dPdx"], "type": "code"}, ", ", {"text": ["dPdy"], "type": "code"}, ", ", {"text": ["dPdz"], "type": "code"}]}, {"body": [{"indent": 8, "type": "para", "extent": [2414, 2461], "text": ["The center of the volume in SOP space."]}], "indent": 0, "type": "dt", "extent": [2404, 2414], "text": [{"text": ["center"], "type": "code"}]}, {"body": [{"indent": 8, "type": "para", "extent": [2472, 2516], "text": ["Current simulation time in seconds."]}], "indent": 0, "type": "dt", "extent": [2461, 2472], "text": [{"text": ["SimTime"], "type": "code"}]}, {"body": [{"indent": 8, "type": "para", "extent": [2528, 2562], "text": ["Current simulation frame."]}], "indent": 0, "type": "dt", "extent": [2516, 2528], "text": [{"text": ["SimFrame"], "type": "code"}]}, {"body": [{"indent": 8, "type": "para", "extent": [2570, 2611], "text": ["Current playbar time in seconds."]}], "indent": 0, "type": "dt", "extent": [2562, 2570], "text": [{"text": ["Time"], "type": "code"}]}, {"body": [{"indent": 8, "type": "para", "extent": [2620, 2660], "text": ["Current playbar time in frames."]}], "indent": 0, "type": "dt", "extent": [2611, 2620], "text": [{"text": ["Frame"], "type": "code"}]}, {"body": [{"indent": 8, "type": "para", "extent": [2671, 2722], "text": ["Time increment between frames, in seconds."]}], "indent": 0, "type": "dt", "extent": [2660, 2671], "text": [{"text": ["TimeInc"], "type": "code"}]}, {"body": [{"indent": 8, "type": "para", "extent": [2770, 2906], "text": ["A string that can be used to refer to the corresponding input\n        of this SOP in vex operations that take file parameters."]}], "indent": 0, "type": "dt", "extent": [2722, 2770], "text": [{"text": ["OpInput1"], "type": "code"}, ", ", {"text": ["OpInput2"], "type": "code"}, ", ", {"text": ["OpInput3"], "type": "code"}, ", ", {"text": ["OpInput4"], "type": "code"}]}], "container": true, "type": "dt_group"}], "indent": 0, "level": 2, "text": ["Bound Variables"], "extent": [1901, 1924], "container": true, "type": "h", "id": null}, {"body": [{"body": [{"body": [{"body": [{"indent": 4, "type": "para", "extent": [2938, 3065], "text": ["Only run the program on these volumes in the input geometry.\n    Leave this blank to modify all volumes in the input."]}, {"indent": 4, "type": "para", "extent": [3065, 3126], "text": ["(See ", {"fragment": "#values", "text": ["reading and writing voxel values"], "value": "#values", "fullpath": "/nodes/dop/gasfieldwrangle#values", "scheme": null, "type": "link"}, " above.)"]}], "indent": 0, "text": ["Group"], "role": "item", "extent": [2930, 2938], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [3189, 3412], "text": ["Only modify fields if their names match this pattern.\n    The default pattern allows any volume to be modified.\n    You can speed up the node by only listing fields that are ", {"text": ["actually"], "type": "em"}, "\n    modified by the snippet."]}, {"indent": 4, "type": "para", "extent": [3412, 3554], "text": ["For example, in the following snippet, only the ", {"text": ["density"], "type": "code"}, " field is modified.\n    The ", {"text": ["temperature"], "type": "code"}, " field is not modified, only read."]}, {"lang": "vex", "indent": 4, "type": "pre", "extent": [3554, 3609], "text": ["\n    @density = @temperature;\n    "]}, {"indent": 4, "type": "para", "extent": [3609, 3903], "text": ["However, the node will both modify ", {"text": ["density"], "type": "code"}, " and ", {"text": ["copy"], "type": "em"}, " ", {"text": ["temperature"], "type": "code"}, ", which uses time and memory.\n    To prevent this, you could set this parameter to ", {"text": ["density"], "type": "code"}, " to prevent the node\n    from copying ", {"text": ["temperature"], "type": "code"}, ". This requires that you explicitly manage the list of writable fields."]}], "indent": 0, "text": ["Fields to Write to"], "role": "item", "extent": [3169, 3189], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [3923, 4131], "text": ["Automatic binding with the ", {"text": ["@"], "type": "code"}, " syntax can be convenient, but if your\n    system becomes more complex there is the risk that a typo in an ", {"text": ["@"], "type": "code"}, " binding\n    will silently just bind a non-existent attribute."]}, {"indent": 4, "type": "para", "extent": [4131, 4228], "text": ["This option forces all ", {"text": ["@"], "type": "code"}, " bindings to be explicitly declared as\n    prototypes before use."]}], "indent": 0, "text": ["Enforce Prototypes"], "role": "item", "extent": [3903, 3923], "type": "parameters_item"}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 2, "text": ["Code"], "extent": [2918, 2930], "container": true, "type": "h", "id": null}, {"body": [{"body": [{"body": [{"indent": 8, "type": "para", "extent": [4270, 4564], "text": ["VEX functions like ", {"text": ["ch()"], "type": "code"}, " usually evaluate with respect to this node.\n        Providing a path here can override where the path search starts\n        from.  This is useful for embedding in a digital asset where you\n        would like the top level digital asset to be the search root."]}], "indent": 4, "text": ["Evaluation Node Path"], "role": "item", "extent": [4243, 4270], "type": "parameters_item"}, {"body": [{"indent": 8, "type": "para", "extent": [4587, 4846], "text": ["This pattern can be used to override\n        the export option on the VEX shader to avoid writing to \n        certain volumes.  The pattern matches the VEX parameter, not\n        the bound volume.  The volume will still be bound for\n        reading."]}], "indent": 4, "text": ["Export Parameters"], "role": "item", "extent": [4564, 4587], "type": "parameters_item"}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 2, "text": ["Bindings"], "extent": [4228, 4243], "container": true, "type": "h", "id": null}, {"body": [{"body": [{"body": [{"indent": 8, "type": "para", "extent": [4878, 4952], "text": ["These control the four virtual inputs accessible inside of VOPs."]}, {"indent": 8, "type": "para", "extent": [4952, 5099], "text": ["They can be accessed with the OpInput1-4 wires from the VOP, or with\n        the ", {"text": ["@OpInput1-4"], "type": "code"}, " string parameters when using VEXpressions."]}, {"indent": 8, "type": "para", "extent": [5099, 5207], "text": ["They can also be accessed numerically as 0-3 with VEX functions\n        that take an input number."]}, {"body": [{"body": [{"indent": 12, "type": "para", "extent": [5221, 5269], "text": ["No geometry is wired to this input."]}], "indent": 8, "type": "dt", "extent": [5207, 5221], "text": ["None"]}, {"body": [{"indent": 12, "type": "para", "extent": [5282, 5399], "text": ["The SOP geometry will be cooked prior to running the VEX and\n            the result wired to this input."]}], "indent": 8, "type": "dt", "extent": [5269, 5282], "text": ["SOP"]}, {"body": [{"indent": 12, "type": "para", "extent": [5417, 5667], "text": ["Data in the current simulation to reference.  Specified as\n            an object/data, for example, ", {"text": ["pyro1/vel"], "type": "code"}, " to refer to the velocity\n            field of the ", {"text": ["pyro1"], "type": "code"}, " object (which will show up as three volume\n            primitives)."]}], "indent": 8, "type": "dt", "extent": [5399, 5417], "text": ["DOP Data"]}, {"body": [{"indent": 12, "type": "para", "extent": [5697, 5776], "text": ["These refer to the SOPs wired into the parent DOP Network itself."]}], "indent": 8, "type": "dt", "extent": [5667, 5697], "text": ["Nth Context Geometry"]}], "container": true, "type": "dt_group"}], "indent": 0, "text": ["Input 1, 2, 3, 4"], "role": "item", "extent": [4859, 4878], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [5790, 5906], "text": ["Whether to scale the Timescale by the current timestep.  If off,\n    timescale is an absolute time in seconds."]}], "indent": 0, "text": ["Use Timestep"], "role": "item", "extent": [5776, 5790], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [5917, 5971], "text": ["An overall scale applied to the actual timestep."]}], "indent": 0, "text": ["Timescale"], "role": "item", "extent": [5906, 5917], "type": "parameters_item"}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 2, "text": ["Inputs"], "extent": [4846, 4859], "container": true, "type": "h", "id": null}], "indent": 0, "level": 1, "text": "Parameters", "role": "section", "extent": [2906, 2918], "container": true, "type": "parameters_section", "id": "parameters"}, {"body": [{"body": [{"indent": 4, "blevel": 6, "type": "bullet", "extent": [5980, 6011], "text": [{"text": "", "fullpath": "/nodes/dop/gasfieldvop", "scheme": "Node", "type": "link", "value": "/nodes/dop/gasfieldvop"}]}], "container": true, "type": "bullet_group"}], "indent": 0, "level": 1, "text": "Related", "role": "section", "extent": [5971, 5980], "container": true, "type": "related_section", "id": "related"}], "title": ["Gas Field Wrangle"], "summary": ["Runs CVEX on a set of fields."], "attrs": {"version": null, "tags": "volumes", "namespace": null, "internal": "gasfieldwrangle", "context": "dop", "type": "node", "icon": "DOP/gas"}, "included": ["/nodes/sop/wrangle_syntax"], "type": "root"}